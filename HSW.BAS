DECLARE SUB KBC ()
DECLARE SUB QF (TEXT$, XS%, YS%, SPACING%, TS!, SO%)
DECLARE SUB SBPLAY2 (freq1%, WAVE1%, FEEDBACK1%, NMBF1%, CLEN1%, WAVES1%, NMBF2%, CLEN2%)
DECLARE SUB SONG (SONGNUM%)
DECLARE SUB SBPLAY3 (freq3%, WAVE3%, FEEDBACK3%, NMBF3%, CLEN3%, WAVES3%)
DECLARE SUB FX (FXX%)
DECLARE SUB SBInit ()
DECLARE SUB SBPLAY (freq%, WAVE%, FEEDBACK%, NMBF%, CLEN%)
DECLARE SUB WRITEREG (Reg%, Value%)
DECLARE SUB SETHUES (HUE() AS ANY, SC%, EC%)
TYPE HUES
   RED AS INTEGER
   GRN AS INTEGER
   BLU AS INTEGER
END TYPE
COMMON SHARED A%, Vol%, FXYN%, NNUM%, SMVol%, SUCCESS%, SMO%, WAVEC2%, COMPUTER.SPEED%
'$DYNAMIC
DEFINT A-Z
DEF SEG = 0
POKE &H417, (Status% XOR &H40)
DEF SEG
CLS : SCREEN 13
 REDIM PAL(255)  AS HUES
 DEF SEG = VARSEG(PAL(0))
 BLOAD "SET.PAL", 0
 SETHUES PAL(), 0, 255
SBInit
Vol% = 0
 DIM PS1(31802)
 DEF SEG = VARSEG(PS1(1))
 BLOAD "BDESIGN2.QBI", VARPTRIM(PS1(1))
 PUT (40, 35), PS1, PSET
 SLEEP 5
 ERASE PS1
 CLS
DIM ROAD1(1)
ERASE ROAD1

OPEN "GAME.DAT" FOR INPUT AS #1
 INPUT #1, COMPUTER.SPEED, FXYN%, SBSound%, SCH%, XMAX%, XMIN%, YMAX%, YMIN%, JK%
CLOSE #1
IF SBSound% = 1 AND SCH% > 1 THEN SMO% = 1
SENSX = 5
SENSY = 2
IF SBSound% = 1 THEN SMO% = 1: FXYN% = 1 ELSE SMO% = 0: FXYN% = 0
    REDIM MLASER1(10)
    REDIM MLASERC(10)
    REDIM RBOSS10(1000)
    REDIM RBOSS11(1000)
    REDIM RBOSSG(100)
    REDIM RBOSS12(1000)
    REDIM RBOSS14(1000)
    REDIM RBOSS15(1000)
    REDIM SLASER1(30)
    ERASE RBOSS10, RBOSS11, RBOSS12, RBOSS14, RBOSS15, RBOSSG, SLASER1
    ERASE MLASER1, MLASERC
    REDIM S1P(1), S2P(1), S3P(1), S1P1(1), S2P1(1), S3P1(1), S4P(1), S4P1(1), PS1(1)
    REDIM SLIDER(1), VOLBOARD(1), TITLE(1)
    ERASE SLIDER, VOLBOARD
    ERASE S1P, S2P, S3P, S4P, S1P1, S2P1, S3P1, S4P1, PS1, TITLE
CLS
YL1 = 100

MENU2:
 CLS
 ERASE S1P, S2P, S3P, S1P1, S2P1, S3P1, PS1, TITLE
 DIM PS1(31802)
 DEF SEG = VARSEG(PS1(1))
 BLOAD "MENUB2.QBI", VARPTRIM(PS1(1))

 DIM TITLE(2992)
 DEF SEG = VARSEG(TITLE(1))
 BLOAD "RW_TITLE.QBI", VARPTRIM(TITLE(1))

 DIM S1P(849)
 DEF SEG = VARSEG(S1P(1))
 BLOAD "PGAME_R.QBI", VARPTRIM(S1P(1))

 DIM S2P(654)
 DEF SEG = VARSEG(S2P(1))
 BLOAD "OPTION1R.QBI", VARPTRIM(S2P(1))

 DIM S3P(377)
 DEF SEG = VARSEG(S3P(1))
 BLOAD "QUIT_R.QBI", VARPTRIM(S3P(1))

 DIM S1P1(849)
 DEF SEG = VARSEG(S1P1(1))
 BLOAD "PGAME1_R.QBI", VARPTRIM(S1P1(1))

 DIM S2P1(654)
 DEF SEG = VARSEG(S2P1(1))
 BLOAD "OPTION_R.QBI", VARPTRIM(S2P1(1))

 DIM S3P1(377)
 DEF SEG = VARSEG(S3P1(1))
 BLOAD "QUIT1_R.QBI", VARPTRIM(S3P1(1))
 PUT (0, 0), PS1, PSET
 PUT (27, 12), TITLE, PSET
 PUT (102, 64), S1P, PSET
 PUT (114, 84), S2P1, PSET
 PUT (130, 104), S3P1, PSET
 SM = 0
 CHM = 0
DO
K$ = INKEY$
KBC
IF K$ = CHR$(27) THEN GOTO ENDING
IF K$ = CHR$(0) + "H" AND SM > 0 THEN SM = SM - 1: CHM = 1
IF K$ = CHR$(0) + "P" AND SM < 2 THEN SM = SM + 1: CHM = 1
IF K$ = "B" THEN
 FX 14
 IF INV = 0 THEN
  INV = 1
 ELSE
  INV = 0
 END IF
END IF
IF K$ = CHR$(13) THEN
    ERASE S1P, S2P, S3P, S1P1, S2P1, S3P1, PS1, TITLE
    FX 17
    SELECT CASE SM
     CASE IS = 0
      GOSUB SDIFF
      GOSUB LOAD
      GOTO START
     CASE IS = 1
      GOTO OPTIONS.MENU
     CASE IS = 2
      GOTO ENDING
    END SELECT
END IF
  IF CHM = 1 THEN
   CHM = 0
   FX 14
   SELECT CASE SM
    CASE IS = 0
     PUT (102, 64), S1P, PSET
     PUT (114, 84), S2P1, PSET
     PUT (130, 104), S3P1, PSET
    CASE IS = 1
     PUT (102, 64), S1P1, PSET
     PUT (114, 84), S2P, PSET
     PUT (130, 104), S3P1, PSET
    CASE IS = 2
     PUT (102, 64), S1P1, PSET
     PUT (114, 84), S2P1, PSET
     PUT (130, 104), S3P, PSET
   END SELECT
  END IF
  FOR N = 1 TO COMPUTER.SPEED
   IF 100 = 100 THEN QW = 5
  NEXT N
 LOOP

SDIFF:
 CLS
 ERASE PS1, S1P, S2P, S3P, S4P

 DIM S1P(2095)
 DEF SEG = VARSEG(S1P(1))
 BLOAD "SDIFF1.QBI", VARPTRIM(S1P(1))

 DIM S2P(2095)
 DEF SEG = VARSEG(S2P(1))
 BLOAD "SDIFF2.QBI", VARPTRIM(S2P(1))

 DIM S3P(2095)
 DEF SEG = VARSEG(S3P(1))
 BLOAD "SDIFF3.QBI", VARPTRIM(S3P(1))

 DIM S4P(2095)
 DEF SEG = VARSEG(S4P(1))
 BLOAD "SDIFF4.QBI", VARPTRIM(S4P(1))
 
  PUT (110, 70), S1P, PSET
 SM = 0
 CHM = 0
DO
K$ = INKEY$
KBC
IF K$ = CHR$(27) THEN ERASE S1P, S2P, S3P, S4P: GOTO MENU2
IF K$ = CHR$(0) + "H" AND SM > 0 THEN SM = SM - 1: CHM = 1
IF K$ = CHR$(0) + "P" AND SM < 3 THEN SM = SM + 1: CHM = 1
IF K$ = CHR$(13) THEN
    ERASE S1P, S2P, S3P, S4P
    FX 17
    SELECT CASE SM
     CASE IS = 0
      SKILL = 0
     CASE IS = 1
      SKILL = 1
     CASE IS = 2
      SKILL = 2
     CASE IS = 3
      SKILL = 3
    END SELECT
    RETURN
END IF
  IF CHM = 1 THEN
   CHM = 0
   FX 14
   SELECT CASE SM
    CASE IS = 0
     PUT (110, 70), S1P, PSET
    CASE IS = 1
     PUT (110, 70), S2P, PSET
    CASE IS = 2
     PUT (110, 70), S3P, PSET
    CASE IS = 3
     PUT (110, 70), S4P, PSET
   END SELECT
  END IF
  FOR N = 1 TO COMPUTER.SPEED
   IF 100 = 100 THEN QW = 5
  NEXT N
 LOOP


LOAD:
REDIM LASER1(13)
DEF SEG = VARSEG(LASER1(1))
BLOAD "LASER1.QBI", VARPTRIM(LASER1(1))

REDIM TANK1(135)
DEF SEG = VARSEG(TANK1(1))
BLOAD "ETANK1.QBI", VARPTRIM(TANK1(1))

REDIM TANK2(135)
DEF SEG = VARSEG(TANK2(1))
BLOAD "ETANK2.QBI", VARPTRIM(TANK2(1))

REDIM TANK3(135)
DEF SEG = VARSEG(TANK3(1))
BLOAD "ETANK3.QBI", VARPTRIM(TANK3(1))

REDIM TANK4(270)
DEF SEG = VARSEG(TANK4(1))
BLOAD "ETANK4.QBI", VARPTRIM(TANK4(1))

REDIM TANK6(135)
DEF SEG = VARSEG(TANK6(1))
BLOAD "ETANK6.QBI", VARPTRIM(TANK6(1))

REDIM TANK7(135)
DEF SEG = VARSEG(TANK7(1))
BLOAD "ETANK7.QBI", VARPTRIM(TANK7(1))

REDIM CAR1(135)
DEF SEG = VARSEG(CAR1(1))
BLOAD "RCAR1.QBI", VARPTRIM(CAR1(1))

REDIM LBAR(100)
DEF SEG = VARSEG(LBAR(1))
BLOAD "LBAR1.QBI", VARPTRIM(LBAR(1))

REDIM LBARM(150)
DEF SEG = VARSEG(LBARM(1))
BLOAD "LBAR2.QBI", VARPTRIM(LBARM(1))

REDIM LBOX(70)
DEF SEG = VARSEG(LBOX(1))
BLOAD "LBOX1.QBI", VARPTRIM(LBOX(1))

REDIM LBOXR(75)
DEF SEG = VARSEG(LBOXR(1))
BLOAD "LBOX1R.QBI", VARPTRIM(LBOXR(1))

REDIM FS1(75)
DEF SEG = VARSEG(FS1(1))
BLOAD "FBS1.QBI", VARPTRIM(FS1(1))

REDIM FB1(75)
DEF SEG = VARSEG(FB1(1))
BLOAD "FB1.QBI", VARPTRIM(FB1(1))

REDIM SLASER1(30)
DEF SEG = VARSEG(SLASER1(1))
BLOAD "SLASER1.QBI", VARPTRIM(SLASER1(1))

REDIM BLASER(75)
DEF SEG = VARSEG(BLASER(1))
BLOAD "BLASER0.QBI", VARPTRIM(BLASER(1))

WCOUNT = 10
SC1 = 0
SC2 = 0
SC3 = 0
SC4 = 0
SC5 = 0
SC6 = 0
SC7 = 0
SC8 = 0
SC9 = 0
SC10 = 0
SC11 = 0
SC12 = 0
SC13 = 0
SC14 = 0
SC15 = 0
RETURN

OPTIONS.MENU:
 CLS
 ERASE S1P, S2P, S3P, S4P, S1P1, S2P1, S3P1, S4P1, PS1, TITLE
 DIM PS1(31802)
 DEF SEG = VARSEG(PS1(1))
 BLOAD "MENUB2.QBI", VARPTRIM(PS1(1))

 DIM TITLE(2992)
 DEF SEG = VARSEG(TITLE(1))
 BLOAD "RW_TITLE.QBI", VARPTRIM(TITLE(1))

 IF JK = 1 THEN
  DIM S1P(887)
  DEF SEG = VARSEG(S1P(1))
  BLOAD "KEY1_R.QBI", VARPTRIM(S1P(1))
  DIM S1P1(887)
  DEF SEG = VARSEG(S1P1(1))
  BLOAD "KEY_R.QBI", VARPTRIM(S1P1(1))
 ELSE
  DIM S1P(887)
  DEF SEG = VARSEG(S1P(1))
  BLOAD "JOY1_R.QBI", VARPTRIM(S1P(1))
  DIM S1P1(887)
  DEF SEG = VARSEG(S1P1(1))
  BLOAD "JOY_R.QBI", VARPTRIM(S1P1(1))
 END IF

  DIM S2P(887)
  DEF SEG = VARSEG(S2P(1))
  BLOAD "CAL1_R.QBI", VARPTRIM(S2P(1))

  DIM S3P(887)
  DEF SEG = VARSEG(S3P(1))
  BLOAD "VOLUM1_R.QBI", VARPTRIM(S3P(1))

  DIM S4P(377)
  DEF SEG = VARSEG(S4P(1))
  BLOAD "QUIT_R.QBI", VARPTRIM(S4P(1))

 DIM S2P1(887)
 DEF SEG = VARSEG(S2P1(1))
 BLOAD "CAL_R.QBI", VARPTRIM(S2P1(1))

 DIM S3P1(849)
 DEF SEG = VARSEG(S3P1(1))
 BLOAD "VOLUM_R.QBI", VARPTRIM(S3P1(1))

 DIM S4P1(377)
 DEF SEG = VARSEG(S4P1(1))
 BLOAD "QUIT1_R.QBI", VARPTRIM(S4P1(1))

 PUT (0, 0), PS1, PSET
 PUT (27, 12), TITLE, PSET
 PUT (101, 64), S1P, PSET
 PUT (100, 84), S2P1, PSET
 PUT (115, 104), S3P1, PSET
 PUT (130, 124), S4P1, PSET
 SM = 0
 CHM = 0
DO
K$ = INKEY$
KBC
IF K$ = CHR$(27) THEN GOTO MENU2
IF K$ = CHR$(0) + "H" AND SM > 0 THEN SM = SM - 1: CHM = 1
IF K$ = CHR$(0) + "P" AND SM < 3 THEN SM = SM + 1: CHM = 1
IF K$ = CHR$(13) THEN
   IF SM = 0 THEN
    ERASE S1P, S1P1
    IF JK = 0 THEN
     JK = 1
     DIM S1P(887)
     DEF SEG = VARSEG(S1P(1))
     BLOAD "KEY1_R.QBI", VARPTRIM(S1P(1))
     DIM S1P1(887)
     DEF SEG = VARSEG(S1P1(1))
     BLOAD "KEY_R.QBI", VARPTRIM(S1P1(1))
    ELSE
     JK = 0
     DIM S1P(887)
     DEF SEG = VARSEG(S1P(1))
     BLOAD "JOY1_R.QBI", VARPTRIM(S1P(1))
     DIM S1P1(887)
     DEF SEG = VARSEG(S1P1(1))
     BLOAD "JOY_R.QBI", VARPTRIM(S1P1(1))
    END IF
    CHM = 1
    GOTO 400
   END IF
    ERASE S1P, S2P, S3P, S4P, S1P1, S2P1, S3P1, S4P1, PS1, TITLE
    FX 17
    SELECT CASE SM
     CASE IS = 1
      GOTO JOYSTICK
     CASE IS = 2
      GOTO MENU.SET.VOLUME
     CASE IS = 3
OPEN "GAME.DAT" FOR OUTPUT AS #1
 WRITE #1, COMPUTER.SPEED, FXYN%, SBSound%, SCH%, XMAX%, XMIN%, YMAX%, YMIN%, JK%
CLOSE #1
      GOTO MENU2
    END SELECT
END IF
400 IF CHM = 1 THEN
   CHM = 0
   FX 14
   SELECT CASE SM
    CASE IS = 0
     PUT (101, 64), S1P, PSET
     PUT (100, 84), S2P1, PSET
     PUT (115, 104), S3P1, PSET
     PUT (130, 124), S4P1, PSET
    CASE IS = 1
     PUT (101, 64), S1P1, PSET
     PUT (100, 84), S2P, PSET
     PUT (115, 104), S3P1, PSET
     PUT (130, 124), S4P1, PSET
    CASE IS = 2
     PUT (101, 64), S1P1, PSET
     PUT (100, 84), S2P1, PSET
     PUT (115, 104), S3P, PSET
     PUT (130, 124), S4P1, PSET
    CASE IS = 3
     PUT (101, 64), S1P1, PSET
     PUT (100, 84), S2P1, PSET
     PUT (115, 104), S3P1, PSET
     PUT (130, 124), S4P, PSET
   END SELECT
  END IF
  FOR N = 1 TO COMPUTER.SPEED
   IF 100 = 100 THEN QW = 5
  NEXT N
 LOOP




MENU.SET.VOLUME:
CLS
ERASE SLIDER, VOLBOARD
DIM SLIDER(100)
DEF SEG = VARSEG(SLIDER(1))
BLOAD "SLIDER1.QBI", VARPTRIM(SLIDER(1))

DIM VOLBOARD(632)
DEF SEG = VARSEG(VOLBOARD(1))
BLOAD "VOLBORD.QBI", VARPTRIM(VOLBOARD(1))

SVXT = 120
SVX = 120

PUT (115, 87), VOLBOARD, PSET
PUT (SVX, 100), SLIDER, PSET
Svol = 0
FXYN = 1
DO
GOSUB MUSIC1
K$ = INKEY$
KBC
IF K$ = CHR$(0) + "K" AND Svol > 0 THEN Svol = Svol - 1: CHPV = 1: SVX = SVX - 5
IF K$ = CHR$(0) + "M" AND Svol < 6 THEN Svol = Svol + 1: CHPV = 1: SVX = SVX + 5
IF K$ = CHR$(13) THEN
 CLS
 FX 17
 ERASE SLIDER, VOLBOARD
 GOTO OPTIONS.MENU
END IF
IF CHPV = 1 THEN
 SELECT CASE Svol
  CASE IS = 0
   SMO% = 0
   FXYN = 0
  CASE IS = 1
   FXYN = 1
   SMO% = 1
   Vol% = 12
   SMVol% = 28
  CASE IS = 2
   Vol% = 7
   SMVol% = 21
  CASE IS = 3
   Vol% = 5
   SMVol% = 15
  CASE IS = 4
   Vol% = 0
   SMVol% = 12
  CASE IS = 5
   Vol% = 0
   SMVol% = 7
  CASE IS = 6
   Vol% = 0
   SMVol% = 0
 END SELECT
 CHPV = 0
 'PUT (SVXT, 100), SLIDER, PSET
 PUT (115, 87), VOLBOARD, PSET
 PUT (SVX, 100), SLIDER, PSET
 'SVXT = SVX
 FX 14
END IF
FOR N = 1 TO COMPUTER.SPEED
IF 100 = 100 THEN QW = 5
NEXT N
LOOP

JOYSTICK:
CLS
DO
LOCATE 8, 5
PRINT "MOVE JOYSTICK TO THE UPPER LEFT HAND "
PRINT "CORNER AND PRESS THE SPACE BAR OR BUTTON"
LOOP UNTIL INKEY$ = CHR$(32) OR STRIG(1)
XMIN% = STICK(0)
YMIN% = STICK(1)
SLEEP 1
CLS
DO
LOCATE 8, 5
PRINT "MOVE JOYSTICK TO THE LOWER RIGHT HAND"
PRINT "CORNER AND PRESS THE SPACE BAR OR BUTTON"
LOOP UNTIL INKEY$ = CHR$(32) OR STRIG(1)
XMAX% = STICK(0)
YMAX% = STICK(1)
SLEEP 1
CLS
SENSX = 5
SENSY = 2
GOTO OPTIONS.MENU

MUSIC1:
NNUM% = NNUM% + 1
IF NNUM% >= 42 THEN NNUM% = 0
SONG 2
RETURN

WEAPON.CHANGE:
ERASE CAR1
IF WPN > 5 AND RD = 1 THEN
 WPN = 5: WCOUNT = WCOUNT + 5
 EIX = 7
 ECOL = 122
 FOR I = 1 TO WCOUNT STEP 1
  ECOL = ECOL - 1
  EIX = EIX + 3
  LINE (EIX, 70)-(EIX + 2, 80), ECOL, BF
 NEXT I
END IF
IF WPN > 6 THEN WPN = 6: WCOUNT = WCOUNT + 5
SELECT CASE WPN
 CASE IS = 2
  WBLAST = 0
  LSETX = 5
  DIM CAR1(135)
  DEF SEG = VARSEG(CAR1(1))
  BLOAD "RCAR1.QBI", VARPTRIM(CAR1(1))
  'PUT (170, 130), PAN6.1, PSET
 CASE IS = 3
  WBLAST = 5
  LSETX = 3
  DIM CAR1(135)
  DEF SEG = VARSEG(CAR1(1))
  BLOAD "RCAR2.QBI", VARPTRIM(CAR1(1))
 CASE IS = 5
  LSETX = 5
  DIM CAR1(135)
  DEF SEG = VARSEG(CAR1(1))
  BLOAD "RCAR3.QBI", VARPTRIM(CAR1(1))
 CASE IS = 4
  WBLAST = 4
  LSETX = 4
  DIM CAR1(135)
  DEF SEG = VARSEG(CAR1(1))
  BLOAD "RCAR4.QBI", VARPTRIM(CAR1(1))
 CASE IS = 1
  WBLAST = 0
  LSETX = 5
  DIM CAR1(135)
  DEF SEG = VARSEG(CAR1(1))
  BLOAD "RCAR5.QBI", VARPTRIM(CAR1(1))
 CASE IS = 6
  ERASE MLASERC, MLASER1
  WBLAST = 0
  LSETX = -5
  DIM CAR1(135)
  DEF SEG = VARSEG(CAR1(1))
  BLOAD "RCAR1.QBI", VARPTRIM(CAR1(1))
 
  DIM MLASERC(135)
  DEF SEG = VARSEG(MLASERC(1))
  BLOAD "MLASER.QBI", VARPTRIM(MLASERC(1))

  DIM MLASER1(100)
  DEF SEG = VARSEG(MLASER1(1))
  BLOAD "MLASER0.QBI", VARPTRIM(MLASER1(1))
END SELECT
RETURN

NRD:
CLOSE #2
NT = 0
NR = 0
SECT = 0
RD = RD + 1
OPEN "SWAP.DAT" FOR OUTPUT AS #4
 WRITE #4, RD, SCORE, SECT
CLOSE #4
IF BONUS1 = 2 THEN RD = 2: BONUS1 = 0
IF BONUS1 = 1 THEN RD = 11: BONUS1 = 2
SELECT CASE RD
 CASE IS = 1
  OPEN "ROAD1E.DAT" FOR INPUT AS #2
CLS
 QF "ROAD OF STEEL", 80, 50, 4, .2, 1
 SLEEP 1
 QF "ENTERING SECTOR", 90, 80, 1, .2, 1
 SLEEP 1
CLS
 CASE IS = 2
  OPEN "ROAD2E.DAT" FOR INPUT AS #2
CLS
 QF "HIGHWAY 64", 90, 50, 4, .2, 1
 SLEEP 1
 QF "ENTERING SECTOR", 90, 80, 1, .2, 1
 SLEEP 1
CLS
 CASE IS = 3
  OPEN "ROAD3E.DAT" FOR INPUT AS #2
CLS
 QF "HIGHWAY 64", 90, 50, 4, .2, 1
 SLEEP 1
 QF "ENTERING SECTOR", 90, 80, 1, .2, 1
 SLEEP 1
CLS
 CASE IS = 4
  OPEN "ROAD4E.DAT" FOR INPUT AS #2
CLS
 QF "LAVA ROAD", 90, 50, 4, .2, 1
 SLEEP 1
 QF "ENTERING SECTOR", 90, 80, 1, .2, 1
 SLEEP 1
CLS
 CASE IS = 5
  OPEN "ROAD5E.DAT" FOR INPUT AS #2
 CASE IS = 6
  OPEN "ROAD5E.DAT" FOR INPUT AS #2
 CASE IS = 7
  GOTO ENDGAME
 CASE IS = 11
  OPEN "ROAD1BE.DAT" FOR INPUT AS #2
END SELECT
'LOCATE 2, 2: PRINT "Road"; RD;
OPEN "SWAP.DAT" FOR INPUT AS #4
 INPUT #4, RD$, SCORE$, SECT$
CLOSE #4

QF "ROAD", 5, 7, 1, 0, 0
QF RD$, 55, 7, 1, 0, 0
QF "SCORE", 205, 7, 1, 0, 0
QF SCORE$, 260, 7, 1, 0, 0
QF "ENERGY", 5, 60, 1, 0, 0
 EIX = 7
 ECOL = 109
 FOR I = 1 TO WCOUNT
  ECOL = ECOL - 1
  EIX = EIX + 3
  LINE (EIX, 70)-(EIX + 2, 80), ECOL, BF
 NEXT I
GOTO NEXTR

START:
 
  REDIM EPICK(5770)
  DEF SEG = VARSEG(EPICK(1))
  BLOAD "EPICK1.QBI", VARPTRIM(EPICK(1))

PUT (90, 45), EPICK, PSET
LINE (92, 47)-(199, 79), 70, B
SM = 0: CHM = 0
DO
K$ = INKEY$
KBC
IF K$ = CHR$(27) THEN GOTO MENU2
IF K$ = CHR$(0) + "H" AND SM > 0 THEN SM = SM - 1: CHM = 1
IF K$ = CHR$(0) + "P" AND SM < 2 THEN SM = SM + 1: CHM = 1
IF K$ = CHR$(13) THEN
    SELECT CASE SM
     CASE IS = 0
      EPISODE = 1
      ERASE EPICK
      EXIT DO
    END SELECT
END IF
 IF CHM = 1 THEN
  PUT (90, 45), EPICK, PSET
  CHM = 0
  FX 14
   SELECT CASE SM
    CASE IS = 0
     LINE (92, 47)-(199, 79), 70, B
    CASE IS = 1
     LINE (92, 80)-(199, 112), 70, B
    CASE IS = 2
     LINE (92, 113)-(199, 145), 70, B
   END SELECT
  END IF
  FOR N = 1 TO COMPUTER.SPEED
   IF 100 = 100 THEN QW = 5
  NEXT N
LOOP
IF JK = 0 THEN
 COMPUTER.SPEED1 = COMPUTER.SPEED / 2
ELSE
 COMPUTER.SPEED1 = COMPUTER.SPEED
END IF
CLS
  QF "ONLY YOU CAN RESTORE PEACE AND ORDER", 50, 75, 1, 0, 1
  QF "TO WORLD TRANSPORTATION", 50, 83, 1, 0, 1
  SLEEP 1
  QF "GOOD LUCK", 110, 105, 3, .2, 1
  SLEEP 1
  QF "PRESS ANY KEY TO CONTINUE", 77, 180, 1, .1, 1
  SLEEP
CLS
 QF "ROAD OF STEEL", 80, 50, 4, .2, 1
 SLEEP 1
 QF "ENTERING SECTOR", 90, 80, 1, .2, 1
 SLEEP 1
CLS
SCORE = 0
 QF "ENERGY", 5, 60, 1, 0, 0
 EIX = 7
 ECOL = 109
 FOR I = 1 TO WCOUNT
  ECOL = ECOL - 1
  EIX = EIX + 3
  LINE (EIX, 70)-(EIX + 2, 80), ECOL, BF
 NEXT I

OPEN "ROAD1E.DAT" FOR INPUT AS #2
NT = 0
SECT% = 0
RD = 1
QF "ROAD", 5, 7, 1, 0, 0
QF "1", 55, 7, 1, 0, 0
WPN = 1
GOSUB WEAPON.CHANGE
LSETX = 5
CS1 = 2
X = 130
NR = 0
QF "SCORE", 205, 7, 1, 0, 0
QF SCORE$, 260, 7, 1, 0, 0

NEXTR:
'NT = 0
BS1L = 0
FS1L = 0
FS2L = 0
TSH1 = 0
MSH1 = 0
SECT% = SECT% + 1
OPEN "SWAP.DAT" FOR OUTPUT AS #4
 WRITE #4, RD, SCORE, SECT
CLOSE #4
OPEN "SWAP.DAT" FOR INPUT AS #4
 INPUT #4, RD$, SCORE$, SECT$
CLOSE #4
QF "SECTION", 5, 17, 1, 0, 0
QF SECT$, 55, 17, 1, 0, 0
LAST = 0
TANK1 = 1
TANK2 = 1
'IF X = 160 OR X = 110 THEN GOTO YDIE
NT = NT + 1
Y = 160
'CHDIR "C:\ROADW\ART"
SELECT CASE NR
 CASE IS = 0
  NR = 1
  ERASE ROAD1
 SELECT CASE RD
  CASE IS = 1
    YR1T = 45
    YR1B = 180
   OPEN "ROADW1.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW1.QBI", VARPTRIM(ROAD1(1))
  CASE IS = 2
    YR1T = 0
    YR1B = 0
   OPEN "ROADW6.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW6.QBI", VARPTRIM(ROAD1(1))
  CASE IS = 3
     YR1T = 0
     YR1B = 0
   OPEN "ROADW5.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW5.QBI", VARPTRIM(ROAD1(1))
  CASE IS = 4
     YR1T = 0
     YR1B = 0
   OPEN "ROADW8.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW8.QBI", VARPTRIM(ROAD1(1))
  CASE IS = 5
     YR1T = 0
     YR1B = 0
   OPEN "ROADW7.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW7.QBI", VARPTRIM(ROAD1(1))
  CASE IS = 6
     YR1T = 0
     YR1B = 0
   OPEN "ROADW10.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW10.QBI", VARPTRIM(ROAD1(1))
  CASE IS = 11
    YR1T = 40
    YR1B = 95
   OPEN "ROADW3.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW3.QBI", VARPTRIM(ROAD1(1))
  END SELECT
 CASE IS = 1
  NR = 0
  ERASE ROAD1
 SELECT CASE RD
  CASE IS = 1
   YR1T = 130
   YR1B = 180
   OPEN "ROADW2.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW2.QBI", VARPTRIM(ROAD1(1))
  CASE IS = 2
    YR1T = 0
    YR1B = 0
   OPEN "ROADW6.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW6.QBI", VARPTRIM(ROAD1(1))
  CASE IS = 3
     YR1T = 0
     YR1B = 0
   OPEN "ROADW5.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW5.QBI", VARPTRIM(ROAD1(1))
  CASE IS = 4
     YR1T = 0
     YR1B = 0
   OPEN "ROADW8.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW8.QBI", VARPTRIM(ROAD1(1))
  CASE IS = 5
     YR1T = 0
     YR1B = 0
   OPEN "ROADW9.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW9.QBI", VARPTRIM(ROAD1(1))
  CASE IS = 6
     YR1T = 0
     YR1B = 0
   OPEN "ROADW10.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW10.QBI", VARPTRIM(ROAD1(1))
  CASE IS = 11
    YR1T = 40
    YR1B = 125
   OPEN "ROADW4.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW4.QBI", VARPTRIM(ROAD1(1))
  END SELECT
END SELECT
'CHDIR "C:\ROADW"
IF NT < 16 THEN INPUT #2, TANK1%, TANK2%, TANKS1%, LBAR1%, LBAR2%, LBAR3%, TSFOR1%, XTS1%, YTS1%, TFOR1%, XT1%, YT1%, TFOR2%, XT2%, YT2%, YB1%, YB2%, YB3%, FS1%, FSX1%, FSY1%, FS2%, FSX2%, FSY2%, BS1%, BSX1%, BSY1%, CS1%, MTANK1%, MX1%, MY1%, MSFOR1%
IF NT = 15 AND RD = 6 THEN
 IF BOSS = 0 THEN
  BX = 120
  BY = 20
  BSHIELD1 = 10
  NT = 20
  BOSS = 1
   ERASE ROAD1
   YR1T = 0
   YR1B = 0
   OPEN "ROADW10.QBI" FOR INPUT AS #1
    FILESIZE& = LOF(1)
   CLOSE #1
    ARY = (FILESIZE& - 7) / 2 - 1
    DIM ROAD1(ARY)
    DEF SEG = VARSEG(ROAD1(1))
    BLOAD "ROADW10.QBI", VARPTRIM(ROAD1(1))
   
    REDIM RBOSS10(1000)
    DEF SEG = VARSEG(RBOSS10(1))
    BLOAD "RBOSS1_0.QBI", VARPTRIM(RBOSS10(1))
 
    REDIM RBOSS11(1000)
    DEF SEG = VARSEG(RBOSS11(1))
    BLOAD "RBOSS1_1.QBI", VARPTRIM(RBOSS11(1))
   
    REDIM RBOSS12(1000)
    DEF SEG = VARSEG(RBOSS12(1))
    BLOAD "RBOSS1_2.QBI", VARPTRIM(RBOSS12(1))

    REDIM RBOSS14(1000)
    DEF SEG = VARSEG(RBOSS14(1))
    BLOAD "RBOSS1_4.QBI", VARPTRIM(RBOSS14(1))
   
    REDIM RBOSS15(1000)
    DEF SEG = VARSEG(RBOSS15(1))
    BLOAD "RBOSS1_5.QBI", VARPTRIM(RBOSS15(1))

    REDIM RBOSSG(100)
    DEF SEG = VARSEG(RBOSSG(1))
    BLOAD "RBOSSG1.QBI", VARPTRIM(RBOSSG(1))
   
  GOTO TOP
 END IF
END IF
IF NT = 15 THEN NT = 16
IF NT = 16 THEN
 CLS
  ERASE RBOSS10, RBOSS11, RBOSS12, RBOSS14, RBOSS15, RBOSSG
  IF RD > 10 THEN
   QF "SECRET ROAD " + RD$ + " COMPLETE", 70, 90, 2, 0, 0
  ELSE
   QF "ROAD " + RD$ + " COMPLETE", 90, 90, 2, 0, 0
  END IF
  FX 18
  SLEEP 5
  CLS
  GOTO NRD
END IF
GOTO TOP:


TOP:
GOSUB MUSIC1
'IF RD = 2 THEN
' PUT (95, 80), BRIDGE1, PSET
'END IF
IF BOSS = 0 AND Y > 7 THEN Y = Y - CS1
IF Y < 8 THEN GOTO NEXTR
IF JK = 1 THEN
A$ = INKEY$
KBC
SELECT CASE A$
  CASE IS = "P"
   QF "PRESS ANY KEY", 105, 187, 1, 0, 0
   SLEEP
   LINE (105, 187)-(200, 200), 0, BF
   'CASE IS = CHR$(0) + "P"  'DOWN
  ' UP = 0
  ' IF Y < 160 THEN Y = Y + 3
  CASE IS = CHR$(0) + "H"  'UP
   FX 11
   UP = 1
   IF Y > 20 THEN Y = Y - 4
  CASE IS = CHR$(0) + "M"  'RIGHT
   FX 11
   IF X < 160 THEN X = X + 10
  CASE IS = CHR$(0) + "K"  'LEFT
   FX 11
   IF X > 110 THEN X = X - 10
  CASE IS = CHR$(0) + "P"'DOWN
   FX 11
   IF Y < 150 THEN Y = Y + 4
  CASE IS = CHR$(32)
   IF LAST = 0 THEN
    IF WCN1 = 1 THEN
     WCN1 = 0
     WPN = WPN - 1
     GOSUB WEAPON.CHANGE
    END IF
    IF WCN = 1 THEN
     WCN = 0
     WPN = WPN + 1
     GOSUB WEAPON.CHANGE
    END IF
    FX 10
    YL = Y - 2
    XL = X + LSETX
    WCOUNT = WCOUNT - 1
 EIX = 7
 ECOL = 112
 LINE (7, 70)-(90, 80), 0, BF
 FOR I = 1 TO WCOUNT
  ECOL = ECOL - 1
  EIX = EIX + 3
  LINE (EIX, 70)-(EIX + 2, 80), ECOL, BF
 NEXT I
    LAST = 1
    IF WPN = 6 THEN
     XL1 = X + 19
     YL1 = YL
    END IF
   END IF
  CASE IS = CHR$(27)
   CLS
   CLOSE #1
   CLOSE #2
   ERASE TANK1, TANK2, TANK3, TANK4, TANK6, TANK7, LBARM, LBOX, LBOXR, FB1, FS1, BLASER, SLASER1, LASER1, ROAD1
   GOTO MENU2
END SELECT
ELSE
  A$ = INKEY$
  KBC
  TEMPX = STICK(0)
  TEMPY = STICK(1)
  IF TEMPY < YMIN% + SENSY THEN  'UP
  ' FX 11
   UP = 1
   IF Y > 20 THEN Y = Y - 4
  END IF
  IF TEMPX > XMAX% - SENSX THEN   'RIGHT
  ' FX 11
   IF X < 160 THEN X = X + 10
  END IF
  IF TEMPX < XMIN% + SENSX THEN 'LEFT
  ' FX 11
   IF X > 110 THEN X = X - 10
  END IF
  IF TEMPY > YMAX% - SENSY THEN  'DOWN
   FX 11
   IF Y < 150 THEN Y = Y + 4
  END IF
  IF STRIG(1) THEN
   IF LAST = 0 THEN
    IF WCN1 = 1 THEN
     WCN1 = 0
     WPN = WPN - 1
     GOSUB WEAPON.CHANGE
    END IF
    IF WCN = 1 THEN
     WCN = 0
     WPN = WPN + 1
     GOSUB WEAPON.CHANGE
    END IF
    FX 10
    YL = Y - 2
    XL = X + LSETX
    WCOUNT = WCOUNT - 1
 EIX = 7
 ECOL = 112
 LINE (7, 70)-(90, 80), 0, BF
 FOR I = 1 TO WCOUNT
  ECOL = ECOL - 1
  EIX = EIX + 3
  LINE (EIX, 70)-(EIX + 2, 80), ECOL, BF
 NEXT I
    LAST = 1
    IF WPN = 6 THEN
     XL1 = X + 19
     YL1 = YL
    END IF
   END IF
END IF   'IF STIG(0) THEN
 IF A$ = "P" THEN
   QF "PRESS ANY KEY", 105, 187, 1, 0, 0
   SLEEP
   LINE (105, 187)-(200, 200), 0, BF
 END IF

 IF A$ = CHR$(27) THEN
  CLS
  CLOSE #1
  CLOSE #2
  ERASE TANK1, TANK2, TANK3, TANK4, TANK6, TANK7, LBARM, LBOX, LBOXR, FB1, FS1, BLASER, SLASER1, LASER1, ROAD1
  GOTO MENU2
 END IF
END IF   'IF JK = 1 THEN
'************ CHECK *****************
'IF WPN = 6 THEN
' IF Y < YR1B AND Y > YR1T THEN
'  IF X < 130 THEN X = 130
'  IF X > 140 THEN X = 140
' ELSE
'  IF X < 120 THEN X = 120
'  IF X > 150 THEN X = 150
' END IF
'ELSE
 IF Y < YR1B AND Y > YR1T THEN
  IF X < 120 THEN X = 120
  IF X > 150 THEN X = 150
 END IF
'END IF
'IF RD = 2 THEN
' PUT (95, 80), BRIDGE1, PSET
'END IF

PUT (98, 5), ROAD1, PSET  '103
'IF RD = 2 THEN
' PUT (95, 80), BRIDGE1, PSET
'END IF

IF BOSS > 0 THEN
 SELECT CASE BOSS
  CASE IS = 1
   IF BSHOOTP = 0 THEN
    PUT (BX, BY), RBOSS10, PSET
    PUT (BX + 6, BY + 20), RBOSSG, PSET
    PUT (BX + 30, BY + 20), RBOSSG, PSET
   ELSE
    PUT (BX, BY), RBOSS11, PSET
    PUT (BX + 6, BY + 20), RBOSSG, PSET
    PUT (BX + 30, BY + 20), RBOSSG, PSET
   END IF
  CASE IS = 2
    PUT (BX, BY), RBOSS12, PSET
    PUT (BX + 30, BY + 20), RBOSSG, PSET
  CASE IS = 3
   IF BSHOOTP = 0 THEN
    PUT (BX, BY), RBOSS14, PSET
   ELSE
    PUT (BX, BY), RBOSS15, PSET
   END IF
 END SELECT
 IF BSHOOTP = 1 THEN
  BSP = BSP - 1
  IF BSP <= 0 THEN BSHOOTP = 0
 END IF
 IF BSHOOT = 0 THEN
  BSHOOT = 1
  BXS1 = BX + 8
  BYS1 = BY + 28
  BXS2 = BX + 32
  BYS2 = BY + 28
  IF BOSS = 3 THEN BXS1 = BX + 21
  BSHOOTP = 1
  BSP = 5
 END IF
 IF BSHOOT = 1 THEN
  SELECT CASE BOSS
   CASE IS = 1
    BYS1 = BYS1 + 5: BYS2 = BYS2 + 5
    PUT (BXS1, BYS1), LASER1, PSET
    PUT (BXS2, BYS2), LASER1, PSET
   CASE IS = 2
    BYS2 = BYS2 + 5
    PUT (BXS2, BYS2), LASER1, PSET
   CASE IS = 3
    BYS1 = BYS1 + 5:
    PUT (BXS1, BYS1), SLASER1, PSET
  END SELECT
  IF BYS1 > 160 OR BYS2 > 160 THEN BSHOOT = 0
  IF BYS1 + 10 > Y AND BYS1 < Y + 15 AND BXS1 > X AND BXS1 < X + 15 THEN
   BSHOOT = 0
   GOSUB YDIE
  END IF
  IF BYS2 + 10 > Y AND BYS2 < Y + 15 AND BXS2 > X AND BXS2 < X + 15 THEN
   BSHOOT = 0
   GOSUB YDIE
  END IF
 END IF
 PUT (X, Y), CAR1, PSET
 IF WPN = 6 THEN
  PUT (X - 10, Y + 2), MLASERC, PSET
  PUT (X + 16, Y + 2), MLASERC, PSET
 END IF
 GOTO SHOOT
END IF


' ************* SIDE GUNS *************
IF BS1 = 1 AND SKILL > 0 THEN
 PUT (BSX1, BSY1), FS1, PSET
 IF BS1L = 0 THEN
  FX 5
  BS1L = 1
  BSXL1 = BSX1 + 5
  BSYL1 = BSY1 + 1
 ELSE
  BSXL1 = BSXL1 + 3
  PUT (BSXL1, BSYL1), FB1, PSET
 IF Y < BSYL1 AND Y + 18 > BSYL1 - 2 AND X < BSXL1 + 6 AND X + 12 > BSXL1 THEN
  BS1L = 0
  GOSUB YDIE
 END IF
 IF BSXL1 > 165 THEN BS1L = 0
 END IF
END IF

'*************** FORWARD GUNS *********
IF FS1 = 1 THEN
 PUT (FSX1, FSY1), FS1, PSET
 IF FS1L = 0 THEN
  FX 5
  FS1L = 1
  FSXL1 = FSX1
  FSYL1 = FSY1 + 5
 ELSE
  FSYL1 = FSYL1 + 4
  PUT (FSXL1, FSYL1), FB1, PSET
 IF Y < FSYL1 + 6 AND Y > FSYL1 - 2 AND X < FSXL1 + 6 AND X + 12 > FSXL1 THEN
  FS1L = 0
  GOSUB YDIE
 END IF
 IF FSYL1 > 160 THEN FS1L = 0
 END IF
END IF

IF FS2 = 1 AND SKILL > 0 THEN
 PUT (FSX2, FSY2), FS1, PSET
 IF FS2L = 0 THEN
  FX 5
  FS2L = 1
  FSXL2 = FSX2
  FSYL2 = FSY2 + 5
 ELSE
  FSYL2 = FSYL2 + 4
  PUT (FSXL2, FSYL2), FB1, PSET
 IF Y < FSYL2 + 6 AND Y > FSYL2 - 2 AND X < FSXL2 + 6 AND X + 12 > FSXL2 THEN
  FS2L = 0
  GOSUB YDIE
 END IF
 IF FSYL2 > 160 THEN FS2L = 0
 END IF
END IF

PUT (X, Y), CAR1, PSET
IF WPN = 6 THEN
 PUT (X - 10, Y + 2), MLASERC, PSET
 PUT (X + 16, Y + 2), MLASERC, PSET
END IF

IF LBAR1 = 1 AND NR = 0 THEN
 PUT (108, YB1), LBOX, PSET
 IF B1S > 0 THEN
  B1S = B1S - 1
 ELSE
  IF B1 = 0 THEN
   B1 = 1
   B1S = 2
  ELSE
   B1 = 0
   B1S = 2
  END IF
 END IF
 IF B1 = 0 THEN
  PUT (115, YB1 + 2), LBAR, PSET
 ELSE
  PUT (115, YB1 + 1), LBARM, PSET
 END IF
 PUT (168, YB1), LBOXR, PSET
 IF Y < YB1 + 5 AND Y > YB1 - 2 THEN
  GOSUB YDIE
 END IF
END IF
IF LBAR2 = 1 AND NR = 0 AND YB2 <> 0 THEN
 PUT (108, YB2), LBOXR, PSET
 IF B2S > 0 THEN
  B2S = B2S - 1
 ELSE
  IF B2 = 0 THEN
   PUT (115, YB2 + 2), LBAR, PSET
   B2 = 1
   B2S = 2
  ELSE
   B2 = 0
   B2S = 2
   PUT (115, YB2 + 1), LBARM, PSET
  END IF
 END IF
 IF B2 = 0 THEN
  PUT (115, YB2 + 2), LBAR, PSET
 ELSE
  PUT (115, YB2 + 1), LBARM, PSET
 END IF
 PUT (168, YB2), LBOX, PSET
 IF Y < YB2 + 5 AND Y > YB2 - 2 THEN
  GOSUB YDIE
 END IF
END IF
IF LBAR3 = 1 AND NR = 0 AND YB3 <> 0 AND SKILL > 1 THEN
 PUT (108, YB3), LBOX, PSET
 IF B3S > 0 THEN
  B3S = B3S - 1
 ELSE
  IF B3 = 0 THEN
   PUT (115, YB3 + 2), LBAR, PSET
   B3 = 1
   B3S = 2
  ELSE
   B3 = 0
   B3S = 2
   PUT (115, YB3 + 1), LBARM, PSET
  END IF
 END IF
 IF B3 = 0 THEN
  PUT (115, YB3 + 2), LBAR, PSET
 ELSE
  PUT (115, YB3 + 1), LBARM, PSET
 END IF
 PUT (168, YB3), LBOXR, PSET
 IF Y < YB3 + 5 AND Y > YB3 - 2 THEN
  GOSUB YDIE
 END IF
END IF

'***************** TANK 1 *************
IF TANK1 = 1 AND XT1 <> 0 THEN
 YT1 = YT1 + TFOR1
 IF RD = 4 THEN
  PUT (XT1, YT1 - 10), TANK4, PSET
 ELSE
  PUT (XT1, YT1), TANK2, PSET
 END IF
 IF YT1 > 150 THEN TANK1 = 0
 IF Y < YT1 + 18 AND Y > YT1 - 2 AND X < XT1 + 12 AND X + 12 > XT1 THEN
  GOSUB YDIE
 END IF
END IF

IF TANK2 = 1 AND XT2 <> 0 AND SKILL > 0 THEN
 YT2 = YT2 + TFOR2
 IF RD = 4 THEN
  PUT (XT2, YT2 - 10), TANK4, PSET
 ELSE
  PUT (XT2, YT2), TANK2, PSET
 END IF
 IF YT2 > 150 THEN TANK2 = 0
 IF Y < YT2 + 18 AND Y > YT2 - 2 AND X < XT2 + 12 AND X + 12 > XT2 THEN
  GOSUB YDIE
 END IF
END IF

'***************** TANK SHOOTING 1 *************
IF TANKS1 = 1 AND XTS1 <> 0 AND SKILL > 1 THEN
 YTS1 = YTS1 + TSFOR1
 IF RD = 1 THEN
  PUT (XTS1, YTS1), TANK1, PSET
 ELSE
  PUT (XTS1, YTS1), TANK3, PSET
 END IF
 IF YTS1 > 155 THEN TANKS1 = 0
 IF TSH1 = 0 THEN
  FX 10
  TSXL1 = XTS1 + 5
  TSYL1 = YTS1 + 20
  TSH1 = 1
 END IF
 IF TSH1 = 1 THEN
  TSYL1 = TSYL1 + 6
  PUT (TSXL1, TSYL1), LASER1, PSET
  IF TSYL1 > 150 THEN TSH1 = 2
  IF TSYL1 > Y AND TSYL1 < Y + 18 AND TSXL1 - 1 > X AND TSXL1 < X + 12 THEN
   GOSUB YDIE
  END IF
 END IF
 IF Y < YTS1 + 18 AND Y > YTS1 - 2 AND X < XTS1 + 12 AND X + 12 > XTS1 THEN
  GOSUB YDIE
 END IF
END IF

IF TANKS2 = 1 AND XTS2 <> 0 THEN
 YTS2 = YTS2 + TSFOR2
 PUT (XTS2, YTS2), TANK1, PSET
 IF YTS2 > 155 THEN TANKS2 = 0
 IF Y < YTS2 + 18 AND Y > YTS2 - 2 AND X < XTS2 + 12 AND X + 12 > XTS2 THEN
  GOSUB YDIE
 END IF
END IF
'*********** Mega Tank ***************
IF MTANK1 = 1 AND MX1 <> 0 AND SKILL > 2 THEN
 MY1 = MY1 + MSFOR1
  PUT (MX1, MY1), TANK6, PSET
 IF MY1 > 155 THEN MTANK1 = 0
 IF MSH1 = 0 THEN
  FX 10
  MSXL1 = MX1 + 5
  MSYL1 = MY1 + 20
  MSH1 = 1
  IF MY1 > 80 THEN MSH1 = 2
 END IF
 IF MSH1 = 1 THEN
  MSYL1 = MSYL1 + 6
  PUT (MSXL1, MSYL1), BLASER, PSET
  IF MSYL1 > 150 THEN MSH1 = 0
  IF MSYL1 > Y AND MSYL1 < Y + 18 AND MSXL1 - 1 > X AND MSXL1 < X + 12 THEN
   GOSUB YDIE
  END IF
 END IF
 IF Y < MY1 + 18 AND Y > MY1 - 2 AND X < MX1 + 12 AND X + 12 > MX1 THEN
  GOSUB YDIE
 END IF
END IF


'************ WEAPON *****************
SHOOT:
IF YL < 20 THEN LAST = 0
'IF YL1 < 20 THEN LAST = 0
IF LAST = 1 AND Y > 30 THEN
 YL = YL - 12
 YL1 = YL
 SELECT CASE WPN
  CASE IS = 2
   PUT (XL, YL), LASER1, PSET
  CASE IS = 3
   PUT (XL, YL), LASER1, PSET
   PUT (XL + 4, YL), LASER1, PSET
  CASE IS = 5
   PUT (XL - 1, YL), FB1, PSET
  CASE IS = 4
   PUT (XL, YL), BLASER, PSET
  CASE IS = 1
   PUT (XL - 1, YL), SLASER1, PSET
   PUT (XL + 2, YL), SLASER1, PSET
  CASE IS = 6
   PUT (XL - 5, YL), MLASER1, PSET
   PUT (XL1, YL1), MLASER1, PSET
 END SELECT
IF WPN = 6 THEN
IF YL1 > YB1 - 5 AND YL1 < YB1 + 10 AND XL1 + WBLAST > 164 AND XL1 < 173 AND LBAR1 = 1 THEN
  FX 3
  SCORE = SCORE + 100
  LBAR1 = 0
  LAST = 0
END IF
IF YL1 > YB2 - 5 AND YL1 < YB2 + 10 AND XL1 > 110 AND XL1 - WBLAST < 120 AND LBAR2 = 1 THEN
  FX 3
  SCORE = SCORE + 100
  LBAR2 = 0
  LAST = 0
END IF
IF YL1 > YB3 - 5 AND YL1 < YB3 + 10 AND XL1 + WBLAST > 164 AND XL1 < 173 AND LBAR3 = 1 AND SKILL > 1 THEN
  FX 3
  SCORE = SCORE + 100
  LBAR3 = 0
  LAST = 0
END IF

IF YL1 > YT1 AND YL1 < YT1 + 20 AND XL1 < XT1 + 15 AND XL1 > XT1 AND TANK1 = 1 THEN
  FX 3
  SCORE = SCORE + 75
  TANK1 = 0
  LAST = 0
END IF
IF YL1 > YT2 AND YL1 < YT2 + 20 AND XL1 < XT2 + 15 AND XL1 > XT2 AND TANK2 = 1 AND SKILL > 0 THEN
  FX 3
  SCORE = SCORE + 75
  TANK2 = 0
  LAST = 0
END IF
IF YL1 > YTS1 AND YL1 < YTS1 + 20 AND XL1 < XTS1 + 15 AND XL1 > XTS1 AND TANKS1 = 1 AND SKILL > 1 THEN
  FX 3
  SCORE = SCORE + 125
  TANKS1 = 0
  LAST = 0
END IF
IF YL1 > MY1 AND YL1 < MY1 + 20 AND XL1 < MX1 + 15 AND XL1 > MX1 AND MTANK1 = 1 AND SKILL > 2 THEN
  FX 3
  SCORE = SCORE + 175
  MTANK1 = 0
  LAST = 0
END IF
IF YL1 > YTS2 AND YL1 < YTS2 + 20 AND XL1 < XTS2 + 15 AND XL1 > XTS2 AND TANKS2 = 1 THEN
  FX 3
  SCORE = SCORE + 125
  TANKS2 = 0
  LAST = 0
END IF
IF YL1 > BY AND YL1 < BY + 20 AND XL1 < BX + 13 AND XL1 > BX - 3 AND BOSS = 1 THEN
  FX 3
  SCORE = SCORE + 25
  BSHIELD1 = BSHIELD1 - 1
  IF BSHIELD1 <= 0 THEN
   BOSS = 2
   BSHIELD1 = 10
  END IF
  LAST = 0
END IF
IF YL1 > BY AND YL1 < BY + 20 AND XL1 < BX + 36 AND XL1 > BX + 28 AND BOSS = 2 THEN
  FX 3
  SCORE = SCORE + 25
  BSHIELD1 = BSHIELD1 - 1
  IF BSHIELD1 <= 0 THEN
   BSHOOT = 0
   BOSS = 3
   BSHIELD1 = 10
  END IF
  LAST = 0
END IF
IF YL1 > BY AND YL1 < BY + 20 AND XL1 < BX + 27 AND XL1 > BX + 9 AND BOSS = 3 THEN
  FX 3
  SCORE = SCORE + 25
  BSHIELD1 = BSHIELD1 - 1
  IF BSHIELD1 <= 0 THEN
   BOSS = 0
   NT = 15
   SLEEP 1
   SLEEP 3
   GOTO NEXTR
  END IF
  LAST = 0
END IF
END IF

IF YL > MY1 AND YL < MY1 + 20 AND XL < MX1 + 15 AND XL > MX1 AND MTANK1 = 1 AND SKILL > 2 THEN
  FX 3
  SCORE = SCORE + 175
  MTANK1 = 0
  LAST = 0
END IF
IF YL > YB1 - 5 AND YL < YB1 + 10 AND XL + WBLAST > 164 AND XL < 173 AND LBAR1 = 1 THEN
  FX 3
  SCORE = SCORE + 100
  LBAR1 = 0
  LAST = 0
END IF
IF YL > YB2 - 5 AND YL < YB2 + 10 AND XL > 110 AND XL - WBLAST < 120 AND LBAR2 = 1 THEN
  FX 3
  SCORE = SCORE + 100
  LBAR2 = 0
  LAST = 0
END IF
IF YL > YB3 - 5 AND YL < YB3 + 10 AND XL + WBLAST > 164 AND XL < 173 AND LBAR3 = 1 AND SKILL > 1 THEN
  FX 3
  SCORE = SCORE + 100
  LBAR3 = 0
  LAST = 0
END IF

IF YL > YT1 AND YL < YT1 + 20 AND XL < XT1 + 15 AND XL > XT1 AND TANK1 = 1 THEN
  FX 3
  SCORE = SCORE + 75
  TANK1 = 0
  LAST = 0
END IF
IF YL > YT2 AND YL < YT2 + 20 AND XL < XT2 + 15 AND XL > XT2 AND TANK2 = 1 AND SKILL > 0 THEN
  FX 3
  SCORE = SCORE + 75
  TANK2 = 0
  LAST = 0
END IF
IF YL > YTS1 AND YL < YTS1 + 20 AND XL < XTS1 + 15 AND XL > XTS1 AND TANKS1 = 1 AND SKILL > 1 THEN
  FX 3
  SCORE = SCORE + 125
  TANKS1 = 0
  LAST = 0
END IF
IF YL > YTS2 AND YL < YTS2 + 20 AND XL < XTS2 + 15 AND XL > XTS2 AND TANKS2 = 1 THEN
  FX 3
  SCORE = SCORE + 125
  TANKS2 = 0
  LAST = 0
END IF
IF YL > BY AND YL < BY + 20 AND XL < BX + 13 AND XL > BX - 3 AND BOSS = 1 THEN
  FX 3
  SCORE = SCORE + 25
  BSHIELD1 = BSHIELD1 - 1
  IF BSHIELD1 <= 0 THEN
   BOSS = 2
   BSHIELD1 = 10
  END IF
  LAST = 0
END IF
IF YL > BY AND YL < BY + 20 AND XL < BX + 36 AND XL > BX + 28 AND BOSS = 2 THEN
  FX 3
  SCORE = SCORE + 25
  BSHIELD1 = BSHIELD1 - 1
  IF BSHIELD1 <= 0 THEN
   BSHOOT = 0
   BOSS = 3
   BSHIELD1 = 10
  END IF
  LAST = 0
END IF
IF YL > BY AND YL < BY + 20 AND XL < BX + 27 AND XL > BX + 9 AND BOSS = 3 THEN
  FX 3
  SCORE = SCORE + 25
  BSHIELD1 = BSHIELD1 - 1
  IF BSHIELD1 <= 0 THEN
   BOSS = 0
   NT = 15
   SLEEP 1
   SLEEP 3
   GOTO NEXTR
  END IF
  LAST = 0
END IF
IF WPN = 5 THEN LAST = 1
IF INV = 1 THEN SCORE = 0
OPEN "SWAP.DAT" FOR OUTPUT AS #4
 WRITE #4, RD, SCORE, SECT
CLOSE #4
OPEN "SWAP.DAT" FOR INPUT AS #4
 INPUT #4, RD$, SCORE$, SECT$
CLOSE #4
QF "SCORE", 205, 7, 1, 0, 0
QF SCORE$, 260, 7, 1, 0, 0
IF WCOUNT <= 0 AND WPN > 1 THEN
  WCN1 = 1
  WCOUNT = 5
 END IF
 IF SCORE > 500 AND SC1 = 0 THEN
  SC1 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 1000 AND SC2 = 0 THEN
  SC2 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 1500 AND SC3 = 0 THEN
  SC3 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 2000 AND SC4 = 0 THEN
  SC4 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 2500 AND SC5 = 0 THEN
  SC5 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 3000 AND SC6 = 0 THEN
  SC6 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 3500 AND SC7 = 0 THEN
  SC7 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 4000 AND SC8 = 0 THEN
  SC8 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 4500 AND SC9 = 0 THEN
  SC9 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 5000 AND SC10 = 0 THEN
  SC10 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 6500 AND SC11 = 0 THEN
  SC11 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 7500 AND SC12 = 0 THEN
  SC12 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 9000 AND SC13 = 0 THEN
  SC13 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 10000 AND SC14 = 0 THEN
  SC14 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 IF SCORE >= 10500 AND SC15 = 0 THEN
  SC15 = 1
  WCN = 1
  WCOUNT = WCOUNT + 5
 END IF
 EIX = 7
 ECOL = 112
 LINE (7, 70)-(90, 80), 0, BF
 FOR I = 1 TO WCOUNT
  ECOL = ECOL - 1
  EIX = EIX + 3
  LINE (EIX, 70)-(EIX + 2, 80), ECOL, BF
 NEXT I
END IF
IF WPN = 1 THEN WCOUNT = 10
IF WCOUNT > 20 THEN WCOUNT = 20
IF SCORE >= 2600 AND RD = 1 THEN BONUS1 = 1
DELAY:
FOR I = 1 TO COMPUTER.SPEED1
 IF 15 = 15 THEN D = 1
NEXT I
GOTO TOP

ENDGAME:
QF "YOU SAVED THE U.S. FROM THE ARAB TERRORISTS", 20, 40, 1, .1, 1
QF "AND HAVE RESTORED PEACE AND ORDER TO SOME OF", 20, 50, 1, .1, 1
QF "WORLD TRANSPORTATION.", 20, 60, 1, .1, 1
SLEEP 1
QF "YOU HAVE SUCCEEDED WHERE MANY HAVE FAILED AND", 20, 85, 1, .1, 1
QF "HAVE BEEN AWARDED THE MEDAL OF BRAVERY.", 20, 95, 1, .1, 1
SLEEP 1
'PUT MEDAL
 DIM MED(614)
 DEF SEG = VARSEG(MED(1))
 BLOAD "RMEDAL1.QBI", VARPTRIM(MED(1))
PUT (120, 120), MED, PSET
ERASE MED
SLEEP 2
QF "BUT THE BATTLE IS NOT OVER YET...", 40, 180, 1, .1, 1
SLEEP
CLS
QF "DO YOU HAVE WHAT IT TAKES TO FINISH THE FIGHT?", 20, 40, 1, .2, 1
SLEEP 2
QF "IN EPISODES 2 AND 3 YOU WILL FINISH THE FIGHT", 20, 60, 1, .1, 1
QF "FOR FREEDOM.", 20, 70, 1, .1, 1
SLEEP 1
QF "EPISODES 2 AND 3 HAVE NOT BEEN COMPLETED YET.", 20, 85, 1, .1, 1
QF "IF YOU WANT TO SEE THEM COMPLETED SEND EMAIL", 20, 95, 1, .1, 1
QF "TO ME. AND WHEN I FINISH THEM I WILL SEND THEM", 20, 105, 1, .1, 1
QF "TO YOU.", 20, 115, 1, .1, 1
SLEEP 1
QF "I HOPE YOU LIKED THIS GAME.", 70, 155, 1, .4, 1
SLEEP
CLS
IF INV = 0 THEN
SELECT CASE SKILL
 CASE IS = 0
QF "TRY A HARDER SKILL LEVEL 'TRAINEE' IS TOO EASY", 15, 40, 1, .4, 1
 CASE IS = 1
QF "YOUR GETTING GOOD AT THIS GAME BUT HAVE YOU", 20, 40, 1, .4, 1
QF "FOUND THE SECRET ROAD YET.", 20, 50, 1, .4, 1
 CASE IS = 2
QF "TO GET TO THE SECRET ROAD SHOOT ALL THE", 20, 40, 1, .4, 1
QF "ENEMYS IN ROAD 1. YOU MUST BE PLAYING ON", 20, 50, 1, .4, 1
QF "INTERMEDIATE OR ADVANCED.", 20, 60, 1, .4, 1
 CASE IS = 3
QF "YOU BEAT THE GAME ON THE HARDEST SKILL LEVEL", 20, 40, 1, .4, 1
QF "SO NOW I'LL TELL YOU THE SECRET CHEAT CODE.", 20, 50, 1, .4, 1
QF "PRESS 'B' AT THE MAIN MENU TO TOGGLE", 20, 60, 1, .4, 1
QF "INVULNERABLE ON AND OFF.", 20, 70, 1, .4, 1
BG = BG + 1
END SELECT
SLEEP
IF BG > 2 THEN
 CLS
 QF "YOU BEAT THE GAME 3 TIMES IN A ROW", 20, 40, 1, .4, 1
 QF "ON ADVANCED. YOUR GREAT... ", 20, 50, 1, .4, 1
 QF "I MUST NOT HAVE MADE THE GAME HARD ENOUGH", 20, 60, 1, .4, 1
 QF "I'LL MAKE IT HARDER NEXT TIME.....", 20, 70, 1, .4, 1
 SLEEP
END IF
ELSE
QF "YOU BEAT THE GAME WITH INVULNERABLE ON.", 20, 40, 1, .4, 1
QF "THATS EASY... TRY IT THE RIGHT WAY.", 20, 50, 1, .4, 1
SLEEP
END IF
CLS
ERASE RBOSS10, RBOSS11, RBOSS12, RBOSS14, RBOSS15, RBOSSG, SLASER1
ERASE MLASER1, MLASERC
 OPEN "HISCORE.DAT" FOR INPUT AS #3
  INPUT #3, NAME1$, SCORE1%, NAME2$, SCORE2%, NAME3$, SCORE3%, NAME4$, SCORE4%
 CLOSE #3
 IF SCORE > SCORE4% THEN
  DIM W$(20)
  S = 0
  QF "ENTER YOUR NAME", 100, 70, 1, 0, 0
  LINE (89, 77)-(200, 89), 90, B
  KBC
  DO
INPUTER:
  SLEEP
  A$ = INKEY$
  KBC
  IF A$ = CHR$(8) AND S% = 0 THEN GOTO INPUTER1
  S% = S% + 1
  IF A$ = CHR$(13) THEN EXIT DO
  IF A$ = CHR$(8) AND S% > 1 THEN
   S% = S% - 1
   W$(S%) = " "
   LINE ((S% * 6) + 84, 80)-((S% * 6) + 89, 87), 0, BF
   S% = S% - 1
   GOTO INPUTER:
  END IF
  IF S% > 18 THEN EXIT DO
  A$ = LEFT$(A$, 1)
  QF A$, (S% * 6) + 80, 80, 0, 0, 0
  W$(S%) = A$
  LOOP
  NAME$ = W$(1) + W$(2) + W$(3) + W$(4) + W$(5) + W$(6) + W$(7) + W$(8) + W$(9) + W$(10) + W$(11) + W$(12) + W$(13) + W$(14) + W$(15) + W$(16) + W$(17) + W$(18) + W$(19) + W$(20)
  ERASE W$
  NAME$ = RTRIM$(NAME$)
  CLS
  IF SCORE > SCORE1% THEN
   SCORE4% = SCORE3%
   NAME4$ = NAME3$
   SCORE3% = SCORE2%
   NAME3$ = NAME2$
   SCORE2% = SCORE1%
   NAME2$ = NAME1$
   SCORE1% = SCORE
   NAME1$ = NAME$
   GOTO CHANGE:
  END IF
  IF SCORE > SCORE2% THEN
   SCORE4% = SCORE3%
   NAME4$ = NAME3$
   SCORE3% = SCORE2%
   NAME3$ = NAME2$
   SCORE2% = SCORE
   NAME2$ = NAME$
   GOTO CHANGE
  END IF
  IF SCORE > SCORE3% THEN
   SCORE4% = SCORE3%
   NAME4$ = NAME3$
   SCORE3% = SCORE
   NAME3$ = NAME$
   GOTO CHANGE
  ELSE
   SCORE4% = SCORE
   NAME4$ = NAME$
   GOTO CHANGE
  END IF
CHANGE:
 OPEN "HISCORE.DAT" FOR OUTPUT AS #3
  WRITE #3, NAME1$, SCORE1%, NAME2$, SCORE2%, NAME3$, SCORE3%, NAME4$, SCORE4%
 CLOSE #3
END IF
GOTO MENU2

YDIE:
FX 25
IF INV = 1 THEN
 RETURN
ELSE
 SLEEP 1
 SLEEP 1
 SLEEP 2
 CLS
 CLOSE #1
 CLOSE #2
 OPEN "HISCORE.DAT" FOR INPUT AS #3
  INPUT #3, NAME1$, SCORE1%, NAME2$, SCORE2%, NAME3$, SCORE3%, NAME4$, SCORE4%
 CLOSE #3
 IF SCORE > SCORE4% THEN
  DIM W$(20)
  S = 0
  QF "ENTER YOUR NAME", 100, 70, 1, 0, 0
  LINE (89, 77)-(200, 89), 90, B
  KBC
  DO
INPUTER1:
  SLEEP
  A$ = INKEY$
  KBC
  IF A$ = CHR$(8) AND S% = 0 THEN GOTO INPUTER1
  S% = S% + 1
  IF A$ = CHR$(13) THEN EXIT DO
  IF A$ = CHR$(8) AND S% > 1 THEN
   S% = S% - 1
   W$(S) = " "
   LINE ((S% * 6) + 84, 80)-((S% * 6) + 89, 87), 0, BF
   S% = S% - 1
   GOTO INPUTER1:
  END IF
  IF S% > 18 THEN EXIT DO
  A$ = LEFT$(A$, 1)
  QF A$, (S% * 6) + 80, 80, 0, 0, 0
  W$(S%) = A$
  LOOP
  NAME$ = W$(1) + W$(2) + W$(3) + W$(4) + W$(5) + W$(6) + W$(7) + W$(8) + W$(9) + W$(10) + W$(11) + W$(12) + W$(13) + W$(14) + W$(15) + W$(16) + W$(17) + W$(18) + W$(19) + W$(20)
  ERASE W$
  NAME$ = RTRIM$(NAME$)
  CLS
  IF SCORE > SCORE1% THEN
   SCORE4% = SCORE3%
   NAME4$ = NAME3$
   SCORE3% = SCORE2%
   NAME3$ = NAME2$
   SCORE2% = SCORE1%
   NAME2$ = NAME1$
   SCORE1% = SCORE
   NAME1$ = NAME$
   GOTO CHANGE1
  END IF
  IF SCORE > SCORE2% THEN
   SCORE4% = SCORE3%
   NAME4$ = NAME3$
   SCORE3% = SCORE2%
   NAME3$ = NAME2$
   SCORE2% = SCORE
   NAME2$ = NAME$
   GOTO CHANGE1
  END IF
  IF SCORE > SCORE3% THEN
   SCORE4% = SCORE3%
   NAME4$ = NAME3$
   SCORE3% = SCORE
   NAME3$ = NAME$
   GOTO CHANGE1
  ELSE
   SCORE4% = SCORE
   NAME4$ = NAME$
   GOTO CHANGE1
  END IF
CHANGE1:
 OPEN "HISCORE.DAT" FOR OUTPUT AS #3
  WRITE #3, NAME1$, SCORE1%, NAME2$, SCORE2%, NAME3$, SCORE3%, NAME4$, SCORE4%
 CLOSE #3
END IF
 OPEN "HISCORE.DAT" FOR INPUT AS #3
  INPUT #3, NAME1$, SCORE1$, NAME2$, SCORE2$, NAME3$, SCORE3$, NAME4$, SCORE4$
 CLOSE #3
 IF LEN(SCORE2$) > 4 THEN SX2 = 175 ELSE SX2 = 180
 IF LEN(SCORE3$) > 4 THEN SX3 = 175 ELSE SX3 = 180
 IF LEN(SCORE4$) > 4 THEN SX4 = 175 ELSE SX4 = 180
 QF NAME1$, 60, 70, 1, 0, 0
 QF NAME2$, 60, 85, 1, 0, 0
 QF NAME3$, 60, 100, 1, 0, 0
 QF NAME4$, 60, 115, 1, 0, 0
 QF SCORE1$, 175, 70, 1, 0, 0
 QF SCORE2$, SX2, 85, 1, 0, 0
 QF SCORE3$, SX3, 100, 1, 0, 0
 QF SCORE4$, SX4, 115, 1, 0, 0
 REDIM HIST(983)
 DEF SEG = VARSEG(HIST(1))
 BLOAD "HI_S_T.QBI", VARPTRIM(HIST(1))
 REDIM HISM(983)
 DEF SEG = VARSEG(HISM(1))
 BLOAD "HI_S_M.QBI", VARPTRIM(HISM(1))
 REDIM HISB(983)
 DEF SEG = VARSEG(HISB(1))
 BLOAD "HI_S_B.QBI", VARPTRIM(HISB(1))
 HS = 0
 DO
 SELECT CASE HS
  CASE IS = 0
   HS = 1
   PUT (85, 30), HIST, PSET
  CASE IS = 1
   HS = 2
   PUT (85, 30), HISM, PSET
  CASE IS = 2
   HS = 0
   PUT (85, 30), HISB, PSET
 END SELECT

    FOR N = 1 TO 2
     FOR S = 1 TO COMPUTER.SPEED
     NEXT S
    NEXT

 LOOP UNTIL INKEY$ = CHR$(13) OR STRIG(1)
 ERASE HIST, HISM, HISB
 SCORE = 0
 RD = RD - 1
 GOTO NRD
END IF

ENDING:
CLOSE ALL
CLS
SYSTEM

REM $STATIC
SUB FX (FXX%)
IF FXYN = 1 THEN
SELECT CASE FXX%
 CASE IS = 1
  FOR N = 1 TO 45
   SBPLAY 100, 3, 14, 9, 246
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 2
  FOR N = 1 TO 45
   SBPLAY 100, 1, 14, 9, 246
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 3
  FOR N = 1 TO 45
   SBPLAY3 100, 0, 14, 9, 149, 0
  NEXT N
  CALL WRITEREG(&HB2, &H0)
 CASE IS = 4
  FOR N = 1 TO 45
   SBPLAY 200, 1, 12, 131, 246
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 5
  FOR N = 1 TO 45
   SBPLAY3 240, 1, 4, 9, 246, 0
  NEXT N
  CALL WRITEREG(&HB2, &H0)
 CASE IS = 6
  FOR N = 1 TO 45
   SBPLAY 100, 1, 4, 135, 156
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 7
  FOR N = 1 TO 45
   SBPLAY 100, 1, 2, 65, 246
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 8
  FOR N = 1 TO 45
   SBPLAY 100, 1, 2, 36, 246
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 9
  FOR N = 1 TO 45
   SBPLAY 100, 1, 2, 46, 246
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 10
  FOR N = 1 TO 45
   SBPLAY 100, 2, 2, 26, 246
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 11
  FOR N = 1 TO 45
   SBPLAY 100, 1, 2, 136, 46
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 12
  FOR N = 1 TO 45
   SBPLAY 100, 3, 2, 136, 46
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 13
  FOR N = 1 TO 45
   SBPLAY 100, 1, 2, 36, 136
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 14
  FOR N = 1 TO 45
   SBPLAY 100, 0, 0, 36, 149
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 15
  FOR N = 1 TO 45
   SBPLAY 100, 1, 0, 36, 150
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 16
  FOR N = 1 TO 45
   SBPLAY 100, 1, 4, 56, 246
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 17
  FOR N = 1 TO 45
   SBPLAY 100, 1, 2, 236, 246
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 18
  FOR N = 1 TO 45
   SBPLAY 100, 0, 0, 5, 150
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 19
  FOR N = 1 TO 45
   SBPLAY 100, 1, 2, 235, 19
  NEXT N
  CALL WRITEREG(&HB0, &H0)
 CASE IS = 20
  FOR N = 1 TO 45
  ' SBPLAY3 100, 2, 14, 25, 149, 0
  NEXT N
  CALL WRITEREG(&HB2, &H0)
 CASE IS = 21
  FOR N = 1 TO 45
   SBPLAY3 100, 2, 14, 25, 153, 0
  NEXT N
  CALL WRITEREG(&HB2, &H0)
 CASE IS = 22
  FOR N = 1 TO 45
 '  SBPLAY4 100, 2, 14, 25, 149, 0
  NEXT N
  CALL WRITEREG(&HB3, &H0)
 CASE IS = 23
  FOR N = 1 TO 45
'   SBPLAY4 100, 2, 14, 25, 153, 0
  NEXT N
  CALL WRITEREG(&HB3, &H0)
 CASE IS = 25
  FOR N = 1 TO 45
   SBPLAY3 100, 0, 14, 9, 148, 0
  NEXT N
  CALL WRITEREG(&HB2, &H0)

END SELECT
END IF
IF FXYN = 2 THEN
 SELECT CASE FXX#
 CASE IS = 1, 17
  SOUND 1000, 2
 CASE IS = 2, 11
  SOUND 500, 2
 CASE IS = 3
  SOUND 50, 2
 CASE IS = 14
  FOR I = 100 TO 200 STEP 10
   SOUND I, 1
  NEXT I
 CASE IS = 19
  FOR I = 100 TO 200 STEP 2
   SOUND I, 2
  NEXT I
END SELECT
END IF
END SUB

SUB KBC
DEF SEG = &H40
POKE &H1A, PEEK(&H1C)
END SUB

SUB QF (TEXT$, XS%, YS%, SPACING%, TS!, SO%)
'REDIM QFS!(866)
'DEF SEG = VARSEG(QFS!(0))
'BLOAD "FONT2.QBS", 0
REDIM QFS!(1376)
DEF SEG = VARSEG(QFS!(0))
BLOAD "FONT3.QBS", 0
LOOPT = LEN(TEXT$)
SPI = 866 / 52'442 / 26
FOR I = 1 TO LOOPT
LETR$ = MID$(TEXT$, I, 1)
SELECT CASE LETR$
 CASE IS = "."
L% = 26
 CASE IS = "1"
L% = 27
 CASE IS = "2"
L% = 28
 CASE IS = "3"
L% = 29
 CASE IS = "4"
L% = 30
 CASE IS = "5"
L% = 31
 CASE IS = "6"
L% = 32
 CASE IS = "7"
L% = 33
 CASE IS = "8"
L% = 34
 CASE IS = "9"
L% = 35
 CASE IS = "0"
L% = 36
 CASE IS = "'"
L% = 37
 CASE IS = "?"
L% = 38
 CASE IS = "-"
L% = 39
 CASE IS = "+"
L% = 40
 CASE IS = " "
L% = 50
 CASE IS = "A"
L% = 0
 CASE IS = "B"
L% = 1
 CASE IS = "C"
L% = 2
 CASE IS = "D"
L% = 3
 CASE IS = "E"
L% = 4
 CASE IS = "F"
L% = 5
 CASE IS = "G"
L% = 6
 CASE IS = "H"
L% = 7
 CASE IS = "I"
L% = 8
 CASE IS = "J"
L% = 9
 CASE IS = "K"
L% = 10
 CASE IS = "L"
L% = 11
 CASE IS = "M"
L% = 12
 CASE IS = "N"
L% = 13
 CASE IS = "O"
L% = 14
 CASE IS = "P"
L% = 15
 CASE IS = "Q"
L% = 16
 CASE IS = "R"
L% = 17
 CASE IS = "S"
L% = 18
 CASE IS = "T"
L% = 19
 CASE IS = "U"
L% = 20
 CASE IS = "V"
L% = 21
 CASE IS = "W"
L% = 22
 CASE IS = "X"
L% = 23
 CASE IS = "Y"
L% = 24
 CASE IS = "Z"
L% = 25
END SELECT
IF L% <> 50 THEN
 PUT (XS% + (I * (5 + SPACING%)), YS%), QFS!(L% * SPI), PSET
END IF
IF SO% = 1 THEN
 FX 11
END IF
FOR N = 1 TO COMPUTER.SPEED * TS!
 IF 1 = 1 THEN C = 1
NEXT
NEXT I
ERASE QFS!
END SUB

SUB SBInit
   '  Initialize the sound card
                                         
   '(This is the "quick-and-dirty" method; what it's doing is zeroing out

   '  all of the card's registers.  I haven't had any problems with this.)
   FOR Q = 1 TO &HF5
     CALL WRITEREG(Q, 0)
   NEXT Q
END SUB

SUB SBPLAY (freq%, WAVE%, FEEDBACK%, NMBF%, CLEN%)
                                                         
'CALL WriteReg(&H8, 128)
'9
CALL WRITEREG(&H20, NMBF%)    ' Set modulator's multiple to F
CALL WRITEREG(&H40, 0)    ' Set modulator's level to 40 dB
CALL WRITEREG(&H60, 49)   ' Modulator attack: quick, decay: long

CALL WRITEREG(&H80, 240)   ' Modulator sustain: medium, release: medium
CALL WRITEREG(&HA0, freq%)
'CALL WriteReg(&HB0, 32)
                                                         
CALL WRITEREG(&H23, 1)   ' Set carrier's multiple to 0
CALL WRITEREG(&H43, Vol%)   ' Set carrier's level to 0 dB
CALL WRITEREG(&H63, 215)   ' Carrier attack: quick, decay: long
'246
CALL WRITEREG(&H83, CLEN%)  ' Carrier sustain: quick, release: quick
CALL WRITEREG(&HB0, &H21)  ' Octave
                                                         
CALL WRITEREG(&HE0, WAVE%)         ' Waveform argument for Tom..
                           ' &H00 is the default, but I felt like
'14                           ' dropping it in for you.. :)
CALL WRITEREG(&HC0, FEEDBACK%)
'CALL WriteReg(&HBD, 48)
' I originally had an extra argument, duration!, but for some reason
' I wanted to do the timing outside of this sub..  You can change it back
' if needs require..
                                                         
'TimeUp! = TIMER + duation!
'WHILE TimeUp! > TIMER: WEND  ' Worst you can be off is .182 of a second

END SUB

SUB SBPLAY2 (freq1%, WAVE1%, FEEDBACK1%, NMBF1%, CLEN1%, WAVES1%, NMBF2%, CLEN2%)

CALL WRITEREG(&H1, 32)
'CALL WriteReg(&H8, 128)
'9
CALL WRITEREG(&H21, NMBF1%)    ' Set modulator's multiple to F
CALL WRITEREG(&H41, 0)    ' Set modulator's level to 40 dB
CALL WRITEREG(&H61, 64)   ' Modulator attack: quick, decay: long
CALL WRITEREG(&H81, CLEN1%)   ' Modulator sustain: medium, release: medium
CALL WRITEREG(&HA1, freq1%)

CALL WRITEREG(&H24, NMBF2%)   ' Set carrier's multiple to 0
CALL WRITEREG(&H44, SMVol%)   ' Set carrier's level to 0 dB
CALL WRITEREG(&H64, 215)   ' Carrier attack: quick, decay: long
CALL WRITEREG(&H84, CLEN2%)  ' Carrier sustain: quick, release: quick
CALL WRITEREG(&HB1, &H21)  ' Octave
                                                     
CALL WRITEREG(&HE1, WAVE1%)         ' Waveform argument for Tom..
                           ' &H00 is the default, but I felt like
                           ' dropping it in for you.. :)
CALL WRITEREG(&HE4, WAVEC2%)
CALL WRITEREG(&HC1, FEEDBACK1%)
' I originally had an extra argument, duration!, but for some reason
' I wanted to do the timing outside of this sub..  You can change it back
' if needs require..
                                                     
'TimeUp! = TIMER + duation!
'WHILE TimeUp! > TIMER: WEND  ' Worst you can be off is .182 of a second

END SUB

SUB SBPLAY3 (freq3%, WAVE3%, FEEDBACK3%, NMBF3%, CLEN3%, WAVES3%)

'CALL WriteReg(&H2, 32)
'CALL WriteReg(&H8, 128)
'9
CALL WRITEREG(&H22, NMBF3%)    ' Set modulator's multiple to F
CALL WRITEREG(&H42, 0)    ' Set modulator's level to 40 dB
CALL WRITEREG(&H62, 49)   ' Modulator attack: quick, decay: long
CALL WRITEREG(&H82, 240)   ' Modulator sustain: medium, release: medium

CALL WRITEREG(&HA2, freq3%)

CALL WRITEREG(&H25, 1)   ' Set carrier's multiple to 0
CALL WRITEREG(&H45, Vol%)   ' Set carrier's level to 0 dB
CALL WRITEREG(&H65, 215)   ' Carrier attack: quick, decay: long
CALL WRITEREG(&H85, CLEN3%)  ' Carrier sustain: quick, release: quick
CALL WRITEREG(&HB2, &H21)  ' Octave

CALL WRITEREG(&HE2, WAVE3%)         ' Waveform argument for Tom..
                           ' &H00 is the default, but I felt like
                           ' dropping it in for you.. :)
CALL WRITEREG(&HE5, WAVES3%)         ' Waveform argument for Tom..

CALL WRITEREG(&HC2, FEEDBACK3%)
' I originally had an extra argument, duration!, but for some reason
' I wanted to do the timing outside of this sub..  You can change it back
' if needs require..
                                                    
'TimeUp! = TIMER + duation!
'WHILE TimeUp! > TIMER: WEND  ' Worst you can be off is .182 of a second

END SUB

SUB SETHUES (HUE() AS HUES, SC, EC)
DEFINT A-Z
 OUT &H3C8, SC
 FOR I = SC TO EC
   OUT &H3C9, HUE(I).RED: OUT &H3C9, HUE(I).GRN: OUT &H3C9, HUE(I).BLU
 NEXT

END SUB

SUB SONG (SONGNUM%)
IF SMO% = 1 THEN
SELECT CASE SONGNUM%
CASE IS = 1
'FOR A = 1 TO 3
'FOR M = 1 TO 3
' FOR W = 1 TO 5
  SELECT CASE NNUM%
  'FOR N = 1 TO 145
 CASE IS = 0, 4, 8, 12, 16, 40, 44, 48
   SBPLAY2 230, 1, 0, 9, 240, 1, 9, 246
  FOR N = 1 TO 3
   CALL WRITEREG(&HB1, &H0)
  NEXT N
  ' SLEEP 1
  'FOR N = 1 TO 145
 CASE IS = 1, 5, 9, 13, 17, 41, 45, 49
  CALL WRITEREG(&HB1, &H0)
   SBPLAY2 175, 1, 0, 9, 240, 1, 9, 246
  FOR O = 1 TO 3
   CALL WRITEREG(&HB1, &H0)
  NEXT O
  'FOR N = 1 TO 45
  CALL WRITEREG(&HB1, &H0)
 CASE IS = 2, 6, 10, 14, 18, 42, 46, 50
   SBPLAY2 210, 1, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 3
   CALL WRITEREG(&HB1, &H0)
  NEXT P
   CALL WRITEREG(&HB1, &H0)
 CASE IS = 3, 7, 11, 15, 19, 43, 47, 51
   SBPLAY2 150, 1, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 3
   CALL WRITEREG(&HB1, &H0)
  NEXT P
 ' NEXT W
 'FOR W = 1 TO 5
 ' FOR N = 1 TO 145
  CASE IS = 20, 24, 28, 32, 36
   SBPLAY2 140, 1, 0, 9, 240, 1, 9, 246
  FOR N = 1 TO 3
   CALL WRITEREG(&HB1, &H0)
  NEXT N
'  ' SLEEP 1
  'FOR N = 1 TO 145
'  CALL WriteReg(&HB1, &H0)
  CASE IS = 21, 25, 29, 33, 37
   SBPLAY2 95, 1, 0, 9, 240, 1, 9, 246
  FOR O = 1 TO 3
   CALL WRITEREG(&HB1, &H0)
  NEXT O
  'FOR N = 1 TO 145
'  CALL WriteReg(&HB1, &H0)
  CASE IS = 22, 26, 30, 34, 38
   SBPLAY2 130, 1, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 3
   CALL WRITEREG(&HB1, &H0)
  NEXT P
'   CALL WriteReg(&HB1, &H0)
  CASE IS = 23, 27, 31, 35, 39
   SBPLAY2 110, 1, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 3
   CALL WRITEREG(&HB1, &H0)
  NEXT P
' NEXT W
'NEXT M
' FOR W = 1 TO 5
  'FOR N = 1 TO 145
  CASE IS = 52, 56, 60
   SBPLAY2 190, 3, 0, 9, 240, 1, 9, 246
  FOR N = 1 TO 2
   CALL WRITEREG(&HB1, &H0)
  NEXT N
'  ' SLEEP 1
'  'FOR N = 1 TO 145
'  CALL WriteReg(&HB1, &H0)
  CASE IS = 53, 57, 61
   SBPLAY2 200, 3, 0, 9, 240, 1, 9, 246
  FOR O = 1 TO 3
   CALL WRITEREG(&HB1, &H0)
  NEXT O
'  'FOR N = 1 TO 145
'  CALL WriteReg(&HB1, &H0)
  CASE IS = 54, 58, 62
   SBPLAY2 210, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
'   CALL WriteReg(&HB1, &H0)
  CASE IS = 55, 59, 63
   SBPLAY2 220, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 10
   CALL WRITEREG(&HB1, &H0)
  NEXT P
' NEXT W
'NEXT A
 END SELECT
CASE IS = 2
 SELECT CASE NNUM%
  CASE IS = 0, 7, 14          '************
   SBPLAY2 120, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   IF 100 = 100 THEN DDD = 1
  NEXT P
   CALL WRITEREG(&HB1, &H0)
  CASE IS = 1, 8, 15           '*************
  'SBPLAY2 110, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 60
   IF 100 = 100 THEN DDD = 1
  NEXT P
   CALL WRITEREG(&HB1, &H0)
  CASE IS = 2, 9, 16           '************
   SBPLAY2 100, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 40
   IF 100 = 100 THEN DDD = 1
  NEXT P
   CALL WRITEREG(&HB1, &H0)
  CASE IS = 3, 10, 17
   'SBPLAY2 100, 3, 0, 9, 240, 1, 9, 246
   ' SBPLAY5 250, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 40
   IF 100 = 100 THEN DDD = 1
  NEXT P
   CALL WRITEREG(&HB1, &H0)
  CASE IS = 4, 11, 18
   SBPLAY2 110, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 60
   IF 100 = 100 THEN DDD = 1
  NEXT P
   CALL WRITEREG(&HB1, &H0)
 CASE IS = 5, 12, 19
  SBPLAY2 140, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 6, 13, 20
  SBPLAY2 100, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
 '***********************************************
  CASE IS = 21, 28, 35          '************
   SBPLAY2 180, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 22, 29, 36           '*************
  'SBPLAY2 180, 3, 0, 9, 240, 1, 9, 246
   ' SBPLAY5 250, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 6
   CALL WRITEREG(&HB4, &H0)
  NEXT P
  CASE IS = 23, 30, 37           '************
   SBPLAY2 170, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 24, 31, 38
   'SBPLAY2 170, 3, 0, 9, 240, 1, 9, 246
   ' SBPLAY5 250, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB4, &H0)
  NEXT P
  CASE IS = 25, 32, 39
   SBPLAY2 180, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 6
   CALL WRITEREG(&HB1, &H0)
  NEXT P
 CASE IS = 26, 33, 40
  SBPLAY2 210, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 27, 34, 41
  SBPLAY2 170, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P


' CASE IS = 8
'  SBPLAY2 180, 1, 0, 9, 240, 1, 9, 246
'  FOR P = 1 TO 4
'   CALL WriteReg(&HB1, &H0)
'  NEXT P
' CASE IS = 9
'  'REST**********
'  FOR P = 1 TO 4
'   CALL WriteReg(&HB1, &H0)
'  NEXT P
' CASE IS = 10
  'REST**********
'  FOR P = 1 TO 4
'   CALL WriteReg(&HB1, &H0)
'  NEXT P
' CASE IS = 12
'  SBPLAY2 110, 1, 0, 9, 240, 1, 9, 246
'  FOR P = 1 TO 4
'   CALL WriteReg(&HB1, &H0)
'  NEXT P
' CASE IS = 13
' 'REST**************
'  FOR P = 1 TO 40
'   CALL WriteReg(&HB1, &H0)
'  NEXT P
' CASE IS = 14
 'REST************
'  FOR P = 1 TO 40
'   CALL WriteReg(&HB1, &H0)
'  NEXT P
'
 END SELECT
CASE IS = 3
 SELECT CASE NNUM%
  CASE IS = 0, 7, 14          '************
   SBPLAY2 90, 2, 4, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 1', 7, 14          '************
   'SBPLAY2 110, 1, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 2', 7, 14          '************
   'SBPLAY3 110, 1, 0, 63, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 3', 7, 14          '************
   SBPLAY2 130, 2, 4, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 4', 7, 14          '************
   SBPLAY2 120, 2, 4, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 5', 7, 14          '************
   'SBPLAY2 110, 3, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 6', 7, 14          '************
   'SBPLAY2 110, 1, 0, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 7', 0, 14          '************
   SBPLAY2 90, 3, 6, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 8', 7, 14          '************
   'SBPLAY2 110, 1, 5, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 9', 7, 14          '************
   'SBPLAY2 110, 1, 6, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 10', 7, 14          '************
   SBPLAY2 120, 3, 6, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 11', 7, 14          '************
   SBPLAY2 110, 3, 6, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 12', 7, 14          '************
   'SBPLAY2 110, 3, 6, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
  CASE IS = 13', 7, 14          '************
   'SBPLAY2 110, 3, 5, 9, 240, 1, 9, 246
  FOR P = 1 TO 4
   CALL WRITEREG(&HB1, &H0)
  NEXT P
 END SELECT
END SELECT
END IF
END SUB

SUB WRITEREG (Reg%, Value%)
OUT &H220, Reg%
FOR X = 0 TO writereg.delay1
   A = INP(&H220)
NEXT X
OUT &H223, Value%
FOR X = 0 TO writereg.delay2
   A = INP(&H220)
NEXT X
END SUB

